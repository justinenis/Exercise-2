---
title: "Exercise 2"
output: pdf_document
---

```{r, echo = FALSE, include=FALSE}
library(ggplot2)
library(tidyverse)
library(rsample)
library(caret)
library(modelr)
library(parallel)
library(foreach)
library(mosaic)
library(jtools)
```

## Question 1


```{r, echo = FALSE, include=FALSE}
capmetro = read.csv('/Users/franklinstudent/Desktop/GitHub/Exercise-2/capmetro_UT.csv')


capmetro = mutate(capmetro,
                     day_of_week = factor(day_of_week,
                                          levels=c("Mon", "Tue", "Wed","Thu", "Fri", "Sat", "Sun")),
                     month = factor(month,
                                    levels=c("Sep", "Oct","Nov")))


months = c('Sep', 'Oct', 'Nov')

count_boardings = capmetro %>%
  filter(month %in% months) %>%
  group_by(hour_of_day, day_of_week, month) %>%
  summarize(total_boardings = n(),
            boarding = sum(boarding),
            average_boardings = boarding/total_boardings)

bar_graph = ggplot(count_boardings) + 
  geom_line(aes(x = hour_of_day, y = average_boardings, color = month)) + 
  facet_wrap(~day_of_week) + scale_x_continuous(name = "Hour of Day") + 
  scale_y_continuous(name = "Average Boardings") + ggtitle("Capital Metro") +
  theme(plot.title = element_text(hjust = 0.5)) + labs(color = "Month")
```

```{r, echo=FALSE}
bar_graph
```

Excluding the weekends, peak boardings are broadly similar, which is during evening rush hour. 

The average boardings on Monday are lower in September because of Labor Day. Since its a national holiday, the university is closed and UT students would stay home ana would not need to use the bus. 



Additionally, average boarding is lower on Wed/Thurs/Fri for November because Thanksgiving lands on a Thursday in November, and UT students would most likely not travel during days of that particular week, but instead spending time with family/friends. 

```{r, echo = FALSE}
ggplot(data = capmetro) + 
  geom_point(mapping = aes(x = temperature, y = boarding, color = weekend)) + 
  facet_wrap(~hour_of_day) + ggtitle("Capitol Metro") +
  theme(plot.title = element_text(hjust = 0.5)) + scale_x_continuous(name = "Temperature") +
  scale_y_continuous(name = "Boardings") + labs(color = "Day Type")
```


When holding both hour of day and weekend status constant, it does not appear that temperature has a noticeable effect on the number of UT students riding the bus. This is determined by the observable changes in ridership throughout the day. Within each hour of the day, the quantity of boardings remain similar as the temperature changes. 


\newpage

# Question 2


\newpage


# Question 3

```{r, echo=FALSE, include=FALSE}
german_credit = read.csv('/Users/franklinstudent/Desktop/GitHub/Exercise-2/german_credit.csv')

Credit_Rating = c('good', 'poor', 'terrible')

count_history = german_credit %>%
  filter(history %in% Credit_Rating) %>%
  group_by(history)%>%
  summarize(total_history = n(),
            default = sum(Default == 1),
            Probability = default/total_history)

bar_graph2 = ggplot(data = count_history) + 
  geom_col(mapping = aes(x = Credit_Rating, y = Probability, fill = Credit_Rating), 
           position = 'dodge') + ggtitle("Default Probabilities") +
  theme(plot.title = element_text(hjust = 0.5))

```

```{r, echo=FALSE}
bar_graph2
```


```{r, echo=FALSE, include=FALSE}
glm = glm(Default ~ duration + amount + installment + age + history + 
            purpose + foreign, data = german_credit, family = 'binomial')
```


```{r, echo=FALSE}
summary(glm, scale = TRUE, vifs = TRUE, part.corr = TRUE, confint = TRUE, pvals = FALSE)
```

Notably, the default probabilities are much lower for individuals with either a poor or terrible credit history relative to individuals with a good history. Although, when observing the glm, individuals with either a poor or terrible credit history have a negative effect in regards to defaulting on a loan. I believe that these conflicting observations are due to the bank having a more strict loan process for individuals with either a poor or terrible credit history. Individuals that are in either category are more likely to repay their loans back on time. In contrast, indivuals with a good credit history are given a more lenient loan process and as a result, have a higher probability in defaulting on their loans. 

If the purpose of the model is to screen prospective borrowers to classify them into "high" versus "low" probability of default, then no, I do not believe this data set accomplished its goal. The conclusion from this data set should not be to loan less to individuals to a good credit history. Instead, the end result should be for the bank to apply the same strict loan standards that are applied to others that may have either a poor or terrible credit history. This would give a better source of data and better inform the bank on the probability of default.

\newpage

# Question 4







```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```


